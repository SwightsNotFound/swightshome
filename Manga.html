<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=320, initial-scale=1.0">
    <title>Swightshome - Manga</title>
    <link rel="icon" href="images/littlelink.png" type="image/x-icon">
    <style>
        @font-face {
            font-family: 'Chinacat';
            src: url('fonts/chinacat.ttf') format('truetype');
        }
        @font-face {
    font-family: 'ZenMaruGothic';
    src: url('fonts/ZenMaruGothic-Regular.ttf') format('truetype');
}
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Chinacat', Arial, sans-serif;
            color: white;
            scroll-behavior: smooth;
            overflow-x: hidden;
            background-color: transparent;
        }
        #backdrop {
            position: fixed;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }
        .header {
            background: url('images/overview-cover.jpg') no-repeat center center/cover;
            padding: 120px 20px 80px;
            text-align: center;
            color: white;
            position: relative;
            z-index: 1;
            animation: fadeIn 1s 0.5s forwards;
            opacity: 0;
            margin-top: 0;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .header .overlay {
            background-color: rgba(0, 0, 0, 0.5);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        .header-content {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
        }
        .header-content img {
            width: 150px;
            height: auto;
            border-radius: 50%;
            border: 3px solid #4d8ee6;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .header-content img:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(77, 142, 230, 0.6);
        }
        .header-content h1 {
            font-size: 3em;
            margin: 20px 0;
            color: #4d8ee6;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .header-content p {
            font-size: 1.2em;
            color: #aaa;
            max-width: 800px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }
        .logo-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .logo-links img {
            width: 40px;
            height: 40px;
            transition: transform 0.3s;
        }
        .logo-links a:hover img {
            transform: scale(1.2);
        }
        .navbar {
            background-color: #23272e;
            min-height: 60px;
            width: 100vw;
            position: sticky;
            top: 0;
            z-index: 999;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0;
            animation: navbarFadeIn 0.8s 0.2s forwards;
            opacity: 0;
        }
        @keyframes navbarFadeIn {
            from { opacity: 0; transform: translateY(-40px);}
            to { opacity: 1; transform: translateY(0);}
        }
        .navbar-logo-wrap {
            flex: 0 0 auto;
            margin-right: 0;
            padding-left: 0;
            display: flex;
            align-items: center;
            height: 60px;
        }
        .navbar-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            margin: 0;
            height: 60px;
            padding-left: 20px;
            padding-right: 25px;
            transition: transform 0.2s;
        }
        .navbar-logo img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid #4d8ee6;
        }
        .navbar-logo:hover {
            transform: scale(1.04);
            text-shadow: 0 2px 10px rgba(77,142,230,0.3);
        }
        .navbar-nav {
            position: absolute;
            left: 50%;
            top: 0;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            align-items: center;
            height: 60px;
        }
        .navbar-link {
            color: #4d8ee6;
            text-align: center;
            padding: 12px 20px;
            text-decoration: none;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            border: 2px solid #4d8ee6;
            border-radius: 5px;
            margin: 0 5px;
            background: transparent;
            min-width: 100px;
            box-sizing: border-box;
            font-size: 1rem;
        }
        .navbar-link:hover {
            background-color: #4d8ee6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(77, 142, 230, 0.3);
        }
        .navbar-link.active {
            background-color: #4d8ee6;
            color: white;
        }
        @media (max-width: 800px) {
            .navbar {
                flex-direction: column;
                align-items: flex-start;
                height: auto;
            }
            .navbar-logo-wrap {
                width: 100%;
                justify-content: flex-start;
                height: 60px;
            }
            .navbar-nav {
                position: static;
                left: auto;
                top: auto;
                transform: none;
                margin-left: 0;
                width: 100%;
                justify-content: flex-start;
                height: auto;
                padding-left: 20px;
                margin-bottom: 6px;
            }
        }
        .content-area {
            padding: 40px 20px;
            width: 100vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
        }
        .manga-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 250px minmax(600px, 800px);
            gap: 20px;
            justify-content: center;
        }
        .manga-sidebar {
            position: sticky;
            top: 100px;
            height: fit-content;
            background-color: rgba(30, 30, 30, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(77, 142, 230, 0.3);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: fadeInUp 0.5s 1.2s forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        .manga-main {
            background-color: rgba(30, 30, 30, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(77, 142, 230, 0.3);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: fadeInUp 0.5s 1.3s forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }
        .search-bar {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #4d8ee6;
            border-radius: 5px;
            background-color: rgba(40, 40, 40, 0.8);
            color: white;
            font-family: 'Chinacat', Arial, sans-serif;
            box-sizing: border-box;
        }
        .filter-select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #4d8ee6;
            border-radius: 5px;
            background-color: rgba(40, 40, 40, 0.8);
            color: white;
            font-family: 'Chinacat', Arial, sans-serif;
            box-sizing: border-box;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            font-size: 1.6rem;
            color: #4d8ee6;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(77, 142, 230, 0.3);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section h2::after {
            content: '▼';
            font-size: 14px;
            transition: transform 0.3s;
        }
        .section.collapsed h2::after {
            transform: rotate(-90deg);
        }
        .manga-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .manga-item {
            background-color: rgba(40, 40, 40, 0.6);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(77, 142, 230, 0.2);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            position: relative;
        }
        .manga-item:hover {
            transform: translateY(-3px);
            background-color: rgba(50, 50, 50, 0.8);
            box-shadow: 0 5px 15px rgba(77, 142, 230, 0.2);
            border-color: rgba(77, 142, 230, 0.4);
        }
        .manga-cover {
            width: 50px;
            height: 70px;
            object-fit: cover;
            border-radius: 5px;
            margin-right: 15px;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .manga-item:hover .manga-cover {
            transform: scale(1.05);
        }
        .manga-info {
            flex: 1;
        }
        .manga-title {
            font-size: 1rem;
            color: white;
            margin-bottom: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        .manga-title:hover {
            color: #4d8ee6;
        }
        .manga-meta {
            font-size: 0.8rem;
            color: #aaa;
            margin-bottom: 3px;
        }
        .manga-progress {
            font-size: 0.8rem;
            color: #4d8ee6;
        }
        .manga-status {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        .status-releasing {
            background-color: #4CAF50;
            box-shadow: 0 0 5px #4CAF50;
        }
        .status-finished {
            background-color: #9E9E9E;
        }
        .status-tooltip {
            position: absolute;
            top: -25px;
            right: 0;
            background-color: #2c2c2c;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }
        .manga-status:hover .status-tooltip {
            opacity: 1;
        }
        .manga-flag {
            width: 20px;
            height: auto;
            position: absolute;
            bottom: 10px;
            right: 10px;
            border-radius: 2px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .manga-item:hover .manga-flag {
            opacity: 1;
        }
        .flag-tooltip {
            position: absolute;
            bottom: -25px;
            right: 0;
            background-color: #2c2c2c;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }
        .manga-flag:hover .flag-tooltip {
            opacity: 1;
        }
        .stats-section {
            background-color: rgba(30, 30, 30, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(77, 142, 230, 0.3);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin-top: 20px;
            animation: fadeInUp 0.5s 1.4s forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        .stats-section h2 {
            font-size: 1.6rem;
            color: #4d8ee6;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 1px solid rgba(77, 142, 230, 0.3);
            padding-bottom: 10px;
        }
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 1rem;
        }
        .stat-item span:first-child { color: #aaa; }
        .stat-item span:last-child { color: white; font-weight: bold; }
        
        /* Privacy Policy Styles */
        .privacy-policy, .versions-panel, .credits-panel {
            position: fixed;
            top: 0;
            left: 100%;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 30, 30, 0.95);
            z-index: 2000;
            overflow-y: auto;
            padding: 80px 20px 40px;
            transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .privacy-policy.active, .versions-panel.active, .credits-panel.active {
            transform: translateX(-100%);
        }

        .privacy-policy-content, .versions-content, .credits-content {
            background-color: rgba(40, 40, 40, 0.8);
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.4);
            border: 1px solid rgba(77, 142, 230, 0.2);
        }

        .privacy-policy h1, .versions-panel h1, .credits-panel h1 {
            color: #4d8ee6;
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .privacy-policy p, .versions-panel p, .credits-panel p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .privacy-policy a, .versions-panel a, .credits-panel a {
            color: #4d8ee6;
            text-decoration: none;
            transition: all 0.3s;
        }

        .privacy-policy a:hover, .versions-panel a:hover, .credits-panel a:hover {
            color: #3a7bc8;
            text-decoration: underline;
        }

        .close-privacy, .close-versions, .close-credits {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #4d8ee6;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-privacy:hover, .close-versions:hover, .close-credits:hover {
            background: #3a7bc8;
            transform: rotate(90deg);
        }

        .versions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .version-item {
            background-color: rgba(50, 50, 50, 0.6);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(77, 142, 230, 0.3);
            transition: all 0.3s;
        }

        .version-item:hover {
            background-color: rgba(60, 60, 60, 0.8);
            border-color: rgba(77, 142, 230, 0.6);
        }

        .version-item h3 {
            margin-top: 0;
            color: #4d8ee6;
        }

        .version-item .download-btn {
            display: inline-block;
            background: #4d8ee6;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .version-item .download-btn:hover {
            background: #3a7bc8;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* Animation for main content when panels are active */
        .privacy-active #main-content,
        .credits-active #main-content,
        .versions-active #main-content {
            transform: translateX(-100%);
            filter: blur(2px);
            opacity: 0.7;
        }

        .privacy-active #topbar,
        .credits-active #topbar,
        .versions-active #topbar {
            transform: translateX(-100%);
            filter: blur(2px);
            opacity: 0.7;
        }

        .privacy-active .footer,
        .credits-active .footer,
        .versions-active .footer {
            transform: translateX(-100%);
            filter: blur(2px);
            opacity: 0.7;
        }

        .footer {
            background: rgba(20, 20, 20, 0.9);
            padding: 25px 0;
            text-align: center;
            width: 100%;
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 40px;
            animation: fadeIn 0.5s 1.5s forwards;
            opacity: 0;
        }
        .footer p {
            margin: 0 0 15px 0;
            font-size: 1rem;
            color: #aaa;
        }
        .footer-links {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .footer-links a {
            color: #4d8ee6;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: bold;
        }
        .footer-links a:hover {
            color: #3a7bc8;
            text-decoration: underline;
        }
        .footer-links span {
            color: #555;
        }
        @media (max-width: 1100px) {
            .manga-container {
                grid-template-columns: 250px 1fr;
            }
        }
        @media (max-width: 900px) {
            .manga-container {
                grid-template-columns: 1fr;
            }
            .manga-sidebar {
                position: static;
                margin-bottom: 20px;
            }
            .manga-list {
                grid-template-columns: 1fr;
            }
        }
        @media (max-width: 768px) {
            .header {
                padding: 80px 10px 40px;
            }
            .header-content img {
                width: 100px;
            }
            .header-content h1 {
                font-size: 2.0rem;
            }
            .navbar-logo {
                padding-left: 10px;
                padding-right: 10px;
            }
            .navbar-nav {
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <img id="backdrop" src="images/backdrop.jpg" alt="Fullscreen backdrop">
    <!-- Header -->
    <div class="header">
        <div class="overlay"></div>
        <div class="header-content">
            <img src="images/littlelink.png" alt="Logo">
            <h1>Swight</h1>
            <p>This is a list of all the manga I have read over the years, since 2023-2024, this page is really just a mirror of my Anilist profile that's updated every ten minutes.</p>
            <p>All of this information can also be found on Anilist, MAL and kitsu.</p>
            <div class="logo-links">
                <a href="https://anilist.co/user/Swight/" target="_blank">
                    <img src="images/AniList.svg.png" alt="Anilist Logo">
                </a>
                <a href="https://myanimelist.net/profile/SwightUnkown" target="_blank">
                    <img src="images/myanimelist.png" alt="MyAnimeList Logo">
                </a>
                <a href="https://kitsu.app/users/Swight" target="_blank">
                    <img src="images/kitsu.png" alt="Kitsu Logo">
                </a>
            </div>
        </div>
    </div>
    <!-- Topbar/Navbar -->
    <div class="navbar">
        <div class="navbar-logo-wrap">
            <a href="https://Swightshome.xyz" class="navbar-logo" onclick="event.preventDefault(); window.location.href='https://Swightshome.xyz';">
                <img src="images/littlelink.png" alt="Swightshome Logo"> Swightshome
            </a>
        </div>
        <nav class="navbar-nav">
            <a href="Overview" class="navbar-link">Overview</a>
            <a href="Anime" class="navbar-link">Anime</a>
            <a href="Manga" class="navbar-link active">Manga</a>
            <a href="Books" class="navbar-link">Books</a>
        </nav>
    </div>
    <!-- Content Area -->
    <div class="content-area">
        <div class="manga-container">
            <!-- Sidebar -->
            <div class="manga-sidebar">
                <input type="text" id="searchBar" class="search-bar" placeholder="Search manga...">
                <select id="genreFilter" class="filter-select">
                    <option value="">All Genres</option>
                </select>
                <select id="formatFilter" class="filter-select">
                    <option value="">All Formats</option>
                </select>
                <select id="countryFilter" class="filter-select">
                    <option value="">All Countries</option>
                </select>
                
                <div class="stats-section">
                    <h2>Manga Stats</h2>
                    <div class="stat-item"><span>Count:</span><span id="manga-count">Loading...</span></div>
                    <div class="stat-item"><span>Mean Score:</span><span id="manga-meanScore">Loading...</span></div>
                    <div class="stat-item"><span>Chapters Read:</span><span id="manga-chaptersRead">Loading...</span></div>
                    <div class="stat-item"><span>Volumes Read:</span><span id="manga-volumesRead">Loading...</span></div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="manga-main">
                <div class="section" id="reading">
                    <h2>Reading</h2>
                    <div class="manga-list"></div>
                </div>
                <div class="section" id="completed">
                    <h2>Completed</h2>
                    <div class="manga-list"></div>
                </div>
                <div class="section" id="paused">
                    <h2>Paused</h2>
                    <div class="manga-list"></div>
                </div>
                <div class="section" id="dropped">
                    <h2>Dropped</h2>
                    <div class="manga-list"></div>
                </div>
                <div class="section" id="planning">
                    <h2>Planning</h2>
                    <div class="manga-list"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Made with ❤️ by Swight.</p>
        <div class="footer-links">
            <a href="https://status.swightshome.xyz/status/swightshome" target="_blank" role="button">Status Page</a>
            <span>|</span>
            <a href="https://git.swightshome.xyz/Swight/swightshome" target="_blank" role="button">Source Code</a>
            <span>|</span>
            <a href="#" id="privacy-btn" role="button">Privacy Policy</a>
            <span>|</span>
            <a href="#" id="credits-btn" role="button">Credits</a>
            <span>|</span>
            <a href="#" id="versions-btn" role="button">Versions</a>
        </div>
    </div>

    <!-- Privacy Policy Panel -->
    <div class="privacy-policy" id="privacy-policy">
        <button class="close-privacy" id="close-privacy">×</button>
        <div class="privacy-policy-content">
            <h1>Privacy Policy</h1>
            <p>If you create an account on any service, only the data you give that service will be stored.</p>
            <p>To recieve all data collected on you, you can ask on one of my <a href="#contacts" class="privacy-contact-link">contacts</a>.</p>
            <h1>No information is shared outside of swightshome.xyz</h1>
            <p>Your information will never be shared with a third party unless requierd to by law.</p>
    
            <h1>Deleting your data</h1>
            <p>You can delete any "identifiable" data, but there is a good chance I won't know who "you" are, so i can't delete that data.</p>
            <p>But if I can, reach out to one of my <a href="#contacts" class="privacy-contact-link">contacts</a> and I'll get your data removed.</p>
        </div>
    </div>

    <!-- Credits Panel -->
    <div class="privacy-policy" id="credits-panel">
        <button class="close-privacy" id="close-credits">×</button>
        <div class="privacy-policy-content">
            <h1>Credits</h1>
            <p>Here are some credits for resources used on this website:</p>
            <ul>
                <li>This website is hosted on GitHub Pages, with all services routed through Cloudflare Tunnels.</li>
                <li>All logos displayed on this site belong to their respective owners. I do not claim ownership of any logos other than my own.</li>
                <li>Chart graphs are thank to <a href="https://www.chartjs.org/" target="_blank">Chart.js</a>.</li>
                <li>Fonts used on this site include: Chinacat by Dogstar (Shareware, © 1998) Zen Maru Gothic (SIL Open Font License, © 2007)</li>
                <li>All anime and manga metadata was taken from Anilist through there public API. All novel and audiobook metadata was scraped from StoryGraph.</li>
                <li>The background of the website features the character Reimu Hakurei from the Touhou Project. Specifically, the background belongs to <a href="https://store.steampowered.com/app/882710/_TouHou_Makuka_Sai__Fantastic_Danmaku_Festival/" target="_blank">this game title</a>.</li>
                <li>Various badges are by <a href="https://anilist.co/forum/thread/15027" target="_blank">Yggdorafuwu</a> and <a href="https://anilist.co/forum/thread/10224" target="_blank">Logia</a>.</li>
            </ul>
            <p>Special thanks to all of the above mentioned! :)</p>
        </div>
    </div>

    <!-- Versions Panel -->
    <div class="privacy-policy" id="versions-panel">
        <button class="close-privacy" id="close-versions">×</button>
        <div class="privacy-policy-content">
            <h1>Website Versions</h1>
            <p></p>
            
            <div class="versions-list">
                <div class="version-item">
                    <h3>Version 3.0 (Current)</h3>
                    <p>The latest version completely reworked from the ground up, anime themed, has lots of animations and is much calmer on the eyes. However the site has been heavily downscaled from 2.0.</p>
                    <a href="downloads/swightshome-v3.0.zip" class="download-btn">Download</a>
                </div>
                
                <div class="version-item">
                    <h3>Version 2.0</h3>
                    <p>The most ambitious the site has ever been, made to be completely self-hosted in docker, uses a dark blue and black asthetic. Though in the end it was to much to host on my own.</p>
                    <a href="downloads/swightshome-v2.0.zip" class="download-btn">Download</a>
                </div>
                
                <div class="version-item">
                    <h3>Version 1.0</h3>
                    <p>My first website, and man was it crap, half of its functions where completely borked, but nonetheless it has meaning.</p>
                    <a href="downloads/swightshome-v1.0.zip" class="download-btn">Download</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Manga HTML//
            let lastScrollTop = 0;
            const topbar = document.querySelector('.navbar');

            window.addEventListener('scroll', function() {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                if (scrollTop > lastScrollTop) {
                    topbar.style.transform = 'translateY(-100%)';
                } else {
                    topbar.style.transform = 'translateY(0)';
                }
                lastScrollTop = scrollTop;
            });

            async function fetchMangaList() {
                try {
                    const response = await fetch('json/manga_list.json');
                    const mangaList = await response.json();
                    return mangaList;
                } catch (error) {
                    console.error('Error fetching manga list:', error);
                    return [];
                }
            }

            async function populateMangaList() {
                const mangaList = await fetchMangaList();
                const genres = new Set();
                const formats = new Set();
                const countries = new Set();

                mangaList.forEach(list => {
                    let sectionId;
                    switch (list.name) {
                        case "Reading":
                            sectionId = "reading";
                            break;
                        case "Completed":
                            sectionId = "completed";
                            break;
                        case "Dropped":
                            sectionId = "dropped";
                            break;
                        case "Paused":
                            sectionId = "paused";
                            break;
                        case "Planning":
                            sectionId = "planning";
                            break;
                        default:
                            return;
                    }
                    const section = document.getElementById(sectionId);
                    const ul = section.querySelector('.manga-list');

                    list.entries.forEach(manga => {
                        manga.genres.forEach(genre => genres.add(genre));
                        formats.add(manga.format);
                        countries.add(manga.country);

                        const li = document.createElement('div');
                        li.classList.add('manga-item');

                        // Status dot (always visible)
                        if (manga.status === "RELEASING") {
                            const statusDot = document.createElement('div');
                            statusDot.classList.add('manga-status', 'status-releasing');
                            
                            // Add tooltip for status
                            const tooltip = document.createElement('div');
                            tooltip.classList.add('status-tooltip');
                            tooltip.textContent = 'Currently Publishing';
                            statusDot.appendChild(tooltip);
                            
                            li.appendChild(statusDot);
                        } else if (manga.status === "FINISHED") {
                            const statusDot = document.createElement('div');
                            statusDot.classList.add('manga-status', 'status-finished');
                            
                            // Add tooltip for status
                            const tooltip = document.createElement('div');
                            tooltip.classList.add('status-tooltip');
                            tooltip.textContent = 'Finished Publishing';
                            statusDot.appendChild(tooltip);
                            
                            li.appendChild(statusDot);
                        }

                        // Cover image (clickable)
                        const img = document.createElement('img');
                        img.src = manga.coverImage;
                        img.alt = manga.title;
                        img.classList.add('manga-cover');
                        img.addEventListener('click', () => window.open(manga.links.anilist, '_blank'));
                        li.appendChild(img);

                        // Manga info
                        const infoDiv = document.createElement('div');
                        infoDiv.classList.add('manga-info');

                        // Title (clickable)
                        const title = document.createElement('div');
                        title.textContent = manga.title;
                        title.classList.add('manga-title');
                        title.addEventListener('click', () => window.open(manga.links.anilist, '_blank'));
                        infoDiv.appendChild(title);

                        // Score
                        const score = document.createElement('div');
                        score.textContent = `Score: ${manga.personalScore || 'N/A'}`;
                        score.classList.add('manga-meta');
                        infoDiv.appendChild(score);

                        // Chapters
                        const chapters = document.createElement('div');
                        chapters.textContent = `Chapters: ${manga.progress}/${manga.chapters || '?'}`;
                        chapters.classList.add('manga-meta');
                        infoDiv.appendChild(chapters);

                        // Format
                        const format = document.createElement('div');
                        format.textContent = `${manga.format}`;
                        format.classList.add('manga-meta');
                        infoDiv.appendChild(format);

                        // Genres
                        const genre = document.createElement('div');
                        genre.textContent = `Genres: ${manga.genres.join(', ')}`;
                        genre.classList.add('manga-meta');
                        infoDiv.appendChild(genre);

                        li.appendChild(infoDiv);

                        // Country flag (hidden until hover)
                        const flagImg = document.createElement('img');
                        flagImg.src = `https://flagcdn.com/${manga.country.toLowerCase()}.svg`;
                        flagImg.alt = manga.country;
                        flagImg.classList.add('manga-flag');
                        
                        // Add tooltip for flag
                        const flagTooltip = document.createElement('div');
                        flagTooltip.classList.add('flag-tooltip');
                        flagTooltip.textContent = manga.country;
                        flagImg.appendChild(flagTooltip);
                        
                        li.appendChild(flagImg);

                        ul.appendChild(li);
                    });
                });

                // Populate filter options
                genres.forEach(genre => {
                    const option = document.createElement('option');
                    option.value = genre;
                    option.textContent = genre;
                    document.getElementById('genreFilter').appendChild(option);
                });

                formats.forEach(format => {
                    const option = document.createElement('option');
                    option.value = format;
                    option.textContent = format;
                    document.getElementById('formatFilter').appendChild(option);
                });

                countries.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    document.getElementById('countryFilter').appendChild(option);
                });
            }

            function toggleSection(event) {
                const section = event.target.closest('.section');
                const mangaList = section.querySelector('.manga-list');
                if (mangaList.style.display === "grid") {
                    mangaList.style.display = "none";
                    section.classList.add('collapsed');
                } else {
                    mangaList.style.display = "grid";
                    section.classList.remove('collapsed');
                }
            }

            document.querySelectorAll('.section h2').forEach(header => {
                header.addEventListener('click', toggleSection);
                // Collapse all sections except Reading by default
                if (!header.closest('.section').id.includes('reading')) {
                    header.click();
                }
            });

            // Filter functions
            function filterMangaList() {
                const searchBar = document.getElementById('searchBar').value.toLowerCase();
                const genreFilter = document.getElementById('genreFilter').value.toLowerCase();
                const formatFilter = document.getElementById('formatFilter').value.toLowerCase();
                const countryFilter = document.getElementById('countryFilter').value.toLowerCase();

                document.querySelectorAll('.manga-item').forEach(item => {
                    const title = item.querySelector('.manga-title').textContent.toLowerCase();
                    const metaElements = item.querySelectorAll('.manga-meta');
                    
                    // Get all text content from meta elements for genre search
                    let allMetaText = '';
                    metaElements.forEach(el => {
                        allMetaText += el.textContent.toLowerCase() + ' ';
                    });

                    const matchesSearch = title.includes(searchBar);
                    const matchesGenre = genreFilter ? allMetaText.includes(genreFilter) : true;
                    const matchesFormat = formatFilter ? metaElements[2]?.textContent.toLowerCase().includes(formatFilter) : true;
                    const matchesCountry = countryFilter ? item.querySelector('.manga-flag').alt.toLowerCase().includes(countryFilter) : true;

                    if (matchesSearch && matchesGenre && matchesFormat && matchesCountry) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            }

            document.getElementById('searchBar').addEventListener('input', filterMangaList);
            document.getElementById('genreFilter').addEventListener('change', filterMangaList);
            document.getElementById('formatFilter').addEventListener('change', filterMangaList);
            document.getElementById('countryFilter').addEventListener('change', filterMangaList);

            populateMangaList();

            fetch('json/stats.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data && data.data && data.data.User && data.data.User.statistics) {
                        const mangaStats = data.data.User.statistics.manga;

                        document.getElementById('manga-count').textContent = mangaStats.count;
                        document.getElementById('manga-meanScore').textContent = mangaStats.meanScore;
                        document.getElementById('manga-chaptersRead').textContent = mangaStats.chaptersRead;
                        document.getElementById('manga-volumesRead').textContent = mangaStats.volumesRead;
                    } else {
                        throw new Error('Invalid data structure');
                    }
                })
                .catch(error => {
                    console.error('Error fetching stats:', error);
                });

            // --- Privacy Policy Toggle ---
            const privacyBtn = document.getElementById('privacy-btn');
            const privacyPanel = document.getElementById('privacy-policy');
            const closePrivacy = document.getElementById('close-privacy');
            const body = document.body;

            function closePrivacyPanel() {
                body.classList.remove('privacy-active');
                privacyPanel.classList.remove('active');
            }

            privacyBtn.addEventListener('click', function(e) {
                e.preventDefault();
                body.classList.add('privacy-active');
                privacyPanel.classList.add('active');
            });

            closePrivacy.addEventListener('click', closePrivacyPanel);

            privacyPanel.addEventListener('click', function(e) {
                if (e.target === privacyPanel) {
                    closePrivacyPanel();
                }
            });

            // --- Credits Toggle ---
            const creditsBtn = document.getElementById('credits-btn');
            const creditsPanel = document.getElementById('credits-panel');
            const closeCredits = document.getElementById('close-credits');

            function closeCreditsPanel() {
                body.classList.remove('credits-active');
                creditsPanel.classList.remove('active');
            }

            creditsBtn.addEventListener('click', function(e) {
                e.preventDefault();
                body.classList.add('credits-active');
                creditsPanel.classList.add('active');
            });

            closeCredits.addEventListener('click', closeCreditsPanel);

            creditsPanel.addEventListener('click', function(e) {
                if (e.target === creditsPanel) {
                    closeCreditsPanel();
                }
            });

            // --- Versions Toggle ---
            const versionsBtn = document.getElementById('versions-btn');
            const versionsPanel = document.getElementById('versions-panel');
            const closeVersions = document.getElementById('close-versions');

            function closeVersionsPanel() {
                body.classList.remove('versions-active');
                versionsPanel.classList.remove('active');
            }

            versionsBtn.addEventListener('click', function(e) {
                e.preventDefault();
                body.classList.add('versions-active');
                versionsPanel.classList.add('active');
            });

            closeVersions.addEventListener('click', closeVersionsPanel);

            versionsPanel.addEventListener('click', function(e) {
                if (e.target === versionsPanel) {
                    closeVersionsPanel();
                }
            });

            // Close panels when clicking contact links inside them
            document.querySelectorAll('.privacy-contact-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    // Only handle if it's specifically a privacy contact link
                    if (this.classList.contains('privacy-contact-link')) {
                        e.preventDefault();
                        closePrivacyPanel();
                        closeCreditsPanel();
                        closeVersionsPanel();
                        const targetId = this.getAttribute('href');
                        setTimeout(() => {
                            document.querySelector(targetId).scrollIntoView({ behavior: 'smooth' });
                        }, 100);
                    }
                });
            });
            
            // fix downloads on version page
            // Update the download button handling
            document.querySelectorAll('.download-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    // Only prevent default if it's a download button
                    if (this.classList.contains('download-btn')) {
                        e.preventDefault();
                        const url = this.href;
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = url.split('/').pop();
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    }
                });
            });
        });
    </script>
</body>
</html>